<app-exercise-header [exerciseId]="exerciseId()" [progress]="progress()" />

<section #questions class="flex flex-auto flex-col pb-6 overflow-auto">
  @if (question() >= 1) {
  <div class="flex flex-col gap-2 max-w-2xl mx-auto px-4 py-6 w-full">
    <p class="text-xl leading-relaxed">
      In de vorige opgave heb je de foute regel code aangeduid. Pas nu die foute regel code aan.
    </p>
    <p class="text-xl leading-relaxed">
      Als het programma correct zou werken, dan zou eerst de eerste vrije campingplaats gezocht worden en daarna zou die
      plaats gereserveerd worden door de overeenkomstige waarde in de array op True te zetten.
    </p>
  </div>
  <div class="flex flex-col max-w-2xl mx-auto w-full">
    <pre><code class="pb-1!" language="vbnet">Option Explicit
Option Base 1

Sub CampingPlaatsen()
    Const AANTAL_PLAATSEN As Integer = 10
    Dim boolBezet(AANTAL_PLAATSEN) As Boolean
    Dim intI As Integer
    Dim intVrij As Integer

    intI = 1

    Do While intI <= AANTAL_PLAATSEN
        If CInt(InputBox("Is plaats " & intI & " bezet? (1 = ja, 0 = nee)")) = 1 Then
            boolBezet(intI) = True
        Else
            boolBezet(intI) = False
        End If
        intI = intI + 1
    Loop

    intVrij = ZoekEersteVrijePlaats(boolBezet, AANTAL_PLAATSEN)

</code></pre>
    <mat-form-field appearance="outline" class="code ml-12" subscriptSizing="dynamic">
      <input matInput type="text" [(ngModel)]="question1Answer" />
    </mat-form-field>
    <pre><code class="pt-1!" language="vbnet">

    MsgBox "Gereserveerd: plaats " & intVrij

End Sub

Function ZoekEersteVrijePlaats(ByRef boolBezet() As Boolean, ByVal intAantal As Integer) As Integer

    Dim intI As Integer
    Dim intResultaat As Integer

    intResultaat = 0
    intI = 1

    Do While intI <= intAantal
        If boolBezet(intI) = False And intResultaat = 0 Then
            intResultaat = intI
        End If
        intI = intI + 1
    Loop

    ZoekEersteVrijePlaats = intResultaat

End Function

Sub ReserveerPlaats(ByRef boolBezet() As Boolean, ByVal intPlaats As Integer)
    boolBezet(intPlaats) = True
End Sub
</code></pre>
    @if (question1Checked() || question() > 1) {
    <app-feedback-button [correct]="question1Correct()" [feedback]="question1ShowFeedback()">
      <p correct>
        De subroutine verwacht de volledige array boolBezet() (zie ByRef boolBezet() As Boolean), zodat ze het element
        op intPlaats kan aanpassen. Door enkel boolBezet(intVrij) door te geven geef je maar één True/False-waarde door,
        en kan de subroutine de array niet wijzigen.
      </p>
      <p tip>Verwacht ReserveerPlaats als eerste parameter één element van de array, of de volledige array?</p>
    </app-feedback-button>
    }
  </div>
  }
</section>

<app-exercise-footer
  [checked]="checked()"
  [checking]="checking()"
  [correct]="correct()"
  (check)="check()"
  (continue)="continue()" />
